---
title: "Asm2"
author: "Chan Hou Long, Guyver"
date: "11/4/2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
library(ggplot2)
```

# a
```{r}
vitcap <- readRDS("vitcap.rds")

scat_graph = ggplot(vitcap, aes(x = age, y =vital.capacity)) + 
              geom_point(aes(color = group))
scat_graph

```

# b
```{r}
model_1 = lm(vital.capacity ~ age, data = vitcap)
summary(model_1)
predict(object = model_1, vitcap)
confint(model_1, level=0.95)

scat_graph + geom_smooth(method = "lm", se = TRUE)
```

# c
The residual plot shows a fairly random pattern which is pretty symmetrically distributed. It is also clustered around the lower single digits of the y-axis, suggesting that the relationship between the `age` and the `vital.capacity` is linear.

```{r}
plot(model_1$fitted.values, model_1$res, xlab="Fitted", 
     ylab="Residuals", main="Residual Plot")
abline(h=0)
```

Since the points in the QQ-normal plot mostly lie on a straight diagonal line, the data is normally distributed. From the output, the p-value > 0.05 also implying that the distribution of the data are not significantly different from normal distribution. We can assume the normality.
```{r}
qqnorm(model_1$res, ylab="Residuals")
qqline(model_1$res)
shapiro.test(model_1$res)
```
